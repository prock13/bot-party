<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Bot Party ‚Äî Spyfall Stream</title>
	<link rel="stylesheet" href="/styles.css">
</head>

<body>
	<header>
		<h1>üïµÔ∏è Bot Party ‚Äî Spyfall</h1>
		<div style="display:flex;align-items:center;gap:0.75rem;">
			<span id="status" class="status">Ready</span>
			<button id="analyticsBtn" class="back-btn">üìä Analytics</button>
			<button id="backBtn" class="back-btn" style="display:none;">‚Üê New Game</button>
		</div>
	</header>

	<!-- Provider Status Banner -->
	<div id="providerStatusBanner" class="provider-status-banner" style="display:none;">
		<!-- Will be populated by JS -->
	</div>

	<!-- Config Panel (centered) -->
	<div id="configPanel">
		<div class="config-card">
			<h2>üéÆ Game Setup</h2>

			<div class="config-section">
				<div class="config-label">
					<span>Players</span>
					<span id="playerCount">3 players</span>
				</div>
				<div id="playerList" class="player-list">
					<!-- Player slots will be added here -->
				</div>
				<button type="button" class="add-player-btn" id="addPlayerBtn">+ Add Player</button>
			</div>

			<div class="config-section">
				<div class="setting">
					<label for="locationSelect">Location</label>
					<select id="locationSelect" style="width:100%;">
						<option value="">Random</option>
						<!-- Locations will be populated here -->
					</select>
				</div>
				<div class="location-controls">
					<input type="file" id="locationFileInput" accept=".json" style="display:none;">
					<button type="button" class="secondary-btn" id="importLocationBtn">Import Locations</button>
					<button type="button" class="secondary-btn" id="exportLocationBtn">Export All</button>
					<span id="locationCount" class="location-count">30 locations</span>
				</div>
			</div>

			<div class="config-section">
				<div class="setting">
					<label for="roundsInput">Rounds</label>
					<input type="number" id="roundsInput" value="9" min="1" max="30" style="width:100%;">
				</div>
			</div>

			<div class="config-section">
				<div class="setting">
					<label for="reactionFrequency">AI Reaction Frequency</label>
					<select id="reactionFrequency" style="width:100%;">
						<option value="always">Always (every time)</option>
						<option value="frequent">Frequent (75%)</option>
						<option value="sometimes" selected>Sometimes (50%)</option>
						<option value="rare">Rare (25%)</option>
						<option value="never">Never</option>
					</select>
				</div>
			</div>

		<div class="config-section">
			<label class="checkbox-setting">
				<input type="checkbox" id="allowEarlyVote" checked>
				<span>Allow early accusations (once per player)</span>
			</label>
		</div>

		<button type="button" class="start-btn" id="startBtn">Start Game</button>
		</div>
	</div>

	<!-- Game Panel (log output) -->
	<div id="gamePanel">
		<!-- View Toggle -->
		<div class="game-view-toggle">
			<button id="visualViewBtn" class="view-btn active">üé≠ Visual</button>
			<button id="logViewBtn" class="view-btn">üìú Log</button>
			<div class="divider"></div>
			<button id="pauseBtn" class="control-btn" title="Pause/Resume">‚è∏Ô∏è</button>
			<div class="speed-controls">
				<span class="speed-label">Speed:</span>
				<button id="speed05" class="speed-btn" data-speed="0.5">0.5x</button>
				<button id="speed10" class="speed-btn active" data-speed="1">1x</button>
				<button id="speed15" class="speed-btn" data-speed="1.5">1.5x</button>
				<button id="speed20" class="speed-btn" data-speed="2">2x</button>
			</div>
		</div>

		<!-- Visual Game Board -->
		<div id="visualBoard" class="visual-board">
			<!-- Game Status Bar -->
			<div class="game-status-bar">
				<div class="status-item">
					<span class="status-label">Round:</span>
					<span id="currentRound" class="status-value">-</span>/<span id="totalRounds" class="status-value">-</span>
				</div>
				<div class="status-item">
					<span class="status-label">Phase:</span>
					<span id="currentPhase" class="status-value">Setup</span>
				</div>
				<div class="status-item">
					<span class="status-label">Location:</span>
					<span id="currentLocation" class="status-value">???</span>
				</div>
			</div>

			<!-- Player Ring Container -->
			<div class="player-ring-container">
				<div id="playerRing" class="player-ring">
					<!-- Player cards will be added here dynamically -->
				</div>

				<!-- Turn Indicator (Arrow) -->
				<svg id="turnArrow" class="turn-arrow" style="display:none;">
					<defs>
						<marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
							<polygon points="0 0, 10 3, 0 6" fill="var(--accent)" />
						</marker>
					</defs>
					<line id="arrowLine" x1="0" y1="0" x2="0" y2="0" 
						  stroke="var(--accent)" stroke-width="3" 
						  marker-end="url(#arrowhead)" />
				</svg>

				<!-- Center Info Display -->
				<div class="center-display">
					<div id="turnInfo" class="turn-info" style="display:none;">
						<div class="turn-players">
							<span id="askerName" class="asker-name"></span>
							<span class="turn-arrow-icon">‚Üí</span>
							<span id="targetName" class="target-name"></span>
						</div>
					</div>
				</div>

				<!-- Dialog Display - Speech bubbles positioned near players -->
				<div id="dialogDisplay" class="dialog-display">
					<!-- Speech bubbles will be positioned absolutely near players -->
				</div>
			</div>

			<!-- Reactions Container -->
			<div id="reactionsContainer" class="reactions-container"></div>
		</div>

		<!-- Text Log (traditional view) -->
		<div id="log" style="display:none;"></div>
	</div>

	<!-- Analytics Panel -->
	<div id="analyticsPanel" style="display:none;">
		<div class="analytics-container">
			<h2>üìä Game Analytics</h2>
			
			<div class="analytics-grid">
				<!-- Summary Stats -->
				<div class="analytics-card">
					<h3>Overview</h3>
					<div id="summaryStats">
						<div class="stat-row">
							<span class="stat-label">Total Games:</span>
							<span class="stat-value" id="totalGames">-</span>
						</div>
						<div class="stat-row">
							<span class="stat-label">Avg. Duration:</span>
							<span class="stat-value" id="avgDuration">-</span>
						</div>
						<div class="stat-row">
							<span class="stat-label">Avg. Turns:</span>
							<span class="stat-value" id="avgTurns">-</span>
						</div>
					</div>
				</div>

				<!-- Win Rates by Role -->
				<div class="analytics-card">
					<h3>Win Rates by Role</h3>
					<div id="roleStats">
						<div class="stat-row">
							<span class="stat-label">Spy Wins:</span>
							<span class="stat-value" id="spyWinRate">-</span>
						</div>
						<div class="stat-row">
							<span class="stat-label">Civilian Wins:</span>
							<span class="stat-value" id="civilianWinRate">-</span>
						</div>
					</div>
				</div>

				<!-- Provider Performance -->
				<div class="analytics-card">
					<h3>AI Provider Performance</h3>
					<div id="providerStats">
						<!-- Provider stats will be populated here -->
					</div>
				</div>

				<!-- Location Stats -->
				<div class="analytics-card">
					<h3>Top Locations</h3>
					<div id="locationStats">
						<!-- Location stats will be populated here -->
					</div>
				</div>
			</div>

			<!-- Recent Games -->
			<div class="analytics-card" style="margin-top: 1rem;">
				<h3>Recent Games</h3>
				<div id="recentGames" class="games-list">
					<!-- Recent games will be populated here -->
				</div>
			</div>
		</div>
	</div>

	<script src="/app.js"></script>
</body>

</html>